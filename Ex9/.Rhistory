library(scales)
library(readxl)
library(stats)
econ <- read_excel("Desktop/IST/Probabilidades e Estatística/ProjetoPE2023/Ex1/econ.xlsx",
col_types = c("skip", "skip", "skip",
"numeric", "skip", "numeric"))
tpp <- econ$tpp
z_tpp <- (tpp - mean(tpp)) / sd(tpp)
ndesemp <- econ$ndesemp
z_ndesemp <- (ndesemp - mean(ndesemp)) / sd(ndesemp)
multi <- data.frame(
Parametros = rep(c("z_tpp", "z_ndesemp"), each = length(tpp)),
Ozono = c(z_tpp, z_ndesemp)
)
ggplot(multi, aes(x = Ozono, fill = Parametros)) +
geom_histogram(bins = 100, alpha = 0.6, position = "identity") +
labs(x = expression("Quantidade de Ozono por metro cúbico ug/m"^3),
y = "Frequência")
library(ggplot2)
library(scales)
library(readxl)
library(stats)
econ <- read_excel("Desktop/IST/Probabilidades e Estatística/ProjetoPE2023/Ex1/econ.xlsx",
col_types = c("skip", "skip", "skip",
"numeric", "skip", "numeric"))
tpp <- econ$tpp
z_tpp <- (tpp - mean(tpp)) / sd(tpp)
ndesemp <- econ$ndesemp
z_ndesemp <- (ndesemp - mean(ndesemp)) / sd(ndesemp)
multi <- data.frame(
Parametros = rep(c("z_tpp", "z_ndesemp"), each = length(tpp)),
Ozono = c(z_tpp, z_ndesemp)
)
ggplot(multi, aes(x = Ozono, fill = Parametros)) +
geom_histogram(bins = 100, alpha = 0.6, position = "identity", width = 0.6) +
labs(x = expression("Quantidade de Ozono por metro cúbico ug/m"^3),
y = "Frequência")
library(ggplot2)
library(scales)
library(readxl)
library(stats)
econ <- read_excel("Desktop/IST/Probabilidades e Estatística/ProjetoPE2023/Ex1/econ.xlsx",
col_types = c("skip", "skip", "skip",
"numeric", "skip", "numeric"))
tpp <- econ$tpp
z_tpp <- (tpp - mean(tpp)) / sd(tpp)
ndesemp <- econ$ndesemp
z_ndesemp <- (ndesemp - mean(ndesemp)) / sd(ndesemp)
multi <- data.frame(
Parametros = rep(c("z_tpp", "z_ndesemp"), each = length(tpp)),
Ozono = c(z_tpp, z_ndesemp)
)
ggplot(multi, aes(x = Ozono, fill = Parametros)) +
geom_histogram(bins = 100, alpha = 0.6, position = "identity") +
labs(x = expression("Quantidade de Ozono por metro cúbico ug/m"^3),
y = "Frequência")
library(ggplot2)
library(scales)
library(readxl)
library(stats)
econ <- read_excel("Desktop/IST/Probabilidades e Estatística/ProjetoPE2023/Ex1/econ.xlsx",
col_types = c("skip", "skip", "skip",
"numeric", "skip", "numeric"))
tpp <- econ$tpp
z_tpp <- (tpp - mean(tpp)) / sd(tpp)
ndesemp <- econ$ndesemp
z_ndesemp <- (ndesemp - mean(ndesemp)) / sd(ndesemp)
multi <- data.frame(
Parametros = rep(c("z_tpp", "z_ndesemp"), each = length(tpp)),
Ozono = c(z_tpp, z_ndesemp)
)
ggplot(multi, aes(x = Ozono, fill = Parametros)) +
geom_histogram(bins = 75, alpha = 0.6, position = "identity") +
labs(x = expression("Quantidade de Ozono por metro cúbico ug/m"^3),
y = "Frequência")
install.packages(rio)
install.packages(rio)
library(rio)
install_formats(rio)
install_formats(rio)
install.packages(rio)
library(rio)
library(rio)
library(rio)
library(rio)
library(ggplot2)
library(rio)
library(scales)
library(readxl)
library(stats)
econ <- read_excel("Desktop/IST/Probabilidades e Estatística/ProjetoPE2023/Ex1/econ.xlsx",
col_types = c("skip", "skip", "skip",
"numeric", "skip", "numeric"))
tpp <- econ$tpp
z_tpp <- (tpp - mean(tpp)) / sd(tpp)
ndesemp <- econ$ndesemp
z_ndesemp <- (ndesemp - mean(ndesemp)) / sd(ndesemp)
multi <- data.frame(
Parametros = rep(c("z_tpp", "z_ndesemp"), each = length(tpp)),
Ozono = c(z_tpp, z_ndesemp)
)
ggplot(multi, aes(x = Ozono, fill = Parametros)) +
geom_histogram(bins = 75, alpha = 0.6, position = "identity") +
labs(x = expression("Quantidade de Ozono por metro cúbico ug/m"^3),
y = "Frequência")
library(rio)
urlmy<-"https://web.tecnico.ulisboa.pt/~ist13493/PE_aulas2023/R_Material_exerciciosR/ex1.xlsx"
library(rio)
install_formats()
library(rio)
library(scales)
library(stats)
econ <- read_excel("Desktop/IST/Probabilidades e Estatística/ProjetoPE2023/Ex1/econ.xlsx",
col_types = c("skip", "skip", "skip",
"numeric", "skip", "numeric"))
tpp <- econ$tpp
z_tpp <- (tpp - mean(tpp)) / sd(tpp)
ndesemp <- econ$ndesemp
z_ndesemp <- (ndesemp - mean(ndesemp)) / sd(ndesemp)
multi <- data.frame(
Parametros = rep(c("z_tpp", "z_ndesemp"), each = length(tpp)),
Ozono = c(z_tpp, z_ndesemp)
)
ggplot(multi, aes(x = Ozono, fill = Parametros)) +
geom_histogram(bins = 75, alpha = 0.6, position = "identity") +
labs(x = expression("Quantidade de Ozono por metro cúbico ug/m"^3),
y = "Frequência")
library(ggplot2)
library(rio)
library(scales)
library(stats)
econ <- read_excel("Desktop/IST/Probabilidades e Estatística/ProjetoPE2023/Ex1/econ.xlsx",
col_types = c("skip", "skip", "skip",
"numeric", "skip", "numeric"))
tpp <- econ$tpp
z_tpp <- (tpp - mean(tpp)) / sd(tpp)
ndesemp <- econ$ndesemp
z_ndesemp <- (ndesemp - mean(ndesemp)) / sd(ndesemp)
multi <- data.frame(
Parametros = rep(c("z_tpp", "z_ndesemp"), each = length(tpp)),
Ozono = c(z_tpp, z_ndesemp)
)
ggplot(multi, aes(x = Ozono, fill = Parametros)) +
geom_histogram(bins = 75, alpha = 0.6, position = "identity") +
labs(x = expression("Quantidade de Ozono por metro cúbico ug/m"^3),
y = "Frequência")
library(ggplot2)
library(rio)
library(scales)
library(stats)
econ <- read_excel("Desktop/IST/Probabilidades e Estatística/ProjetoPE2023/Ex1/econ.xlsx",
col_types = c("skip", "skip", "skip",
"numeric", "skip", "numeric"))
tpp <- econ$tpp
z_tpp <- (tpp - mean(tpp)) / sd(tpp)
ndesemp <- econ$ndesemp
z_ndesemp <- (ndesemp - mean(ndesemp)) / sd(ndesemp)
multi <- data.frame(
Parametros = rep(c("z_tpp", "z_ndesemp"), each = length(tpp)),
Ozono = c(z_tpp, z_ndesemp)
)
ggplot(multi, aes(x = Ozono, fill = Parametros)) +
geom_histogram(bins = 50, alpha = 0.6, position = "identity") +
labs(x = expression("Quantidade de Ozono por metro cúbico ug/m"^3),
y = "Frequência")
econ <- read_excel("Desktop/IST/Probabilidades e Estatística/ProjetoPE2023/Ex1/econ.xlsx",
col_types = c("skip", "skip", "skip",
"numeric", "skip", "numeric"))
tpp <- econ$tpp
z_tpp <- (tpp - mean(tpp)) / sd(tpp)
ndesemp <- econ$ndesemp
z_ndesemp <- (ndesemp - mean(ndesemp)) / sd(ndesemp)
multi <- data.frame(
Parametros = rep(c("z_tpp", "z_ndesemp"), each = length(tpp)),
Ozono = c(z_tpp, z_ndesemp)
)
ggplot(multi, aes(x = Ozono, fill = Parametros)) +
geom_histogram(bins = 50, alpha = 0.6, position = "identity") +
labs(x = expression("Quantidade de Ozono por metro cúbico ug/m"^3),
y = "Frequência")
set.seed(1840)
n <- 1192
p <- 0.35
sample <- numeric(n)
# Simulação da distribuição geométrica de parâmetro p
for (i in 1:n) {
u <- runif(1)
x <- floor(log(1 - u) / log(1 - p))
sample[i] <- x
}
# Cálculo da média e do desvio padrão amostrais
mean <- mean(sample)
std <- sd(sample)
# Cálculo da soma da média com o desvio padrão amostrais
sum_mean_std <- mean + std
# Contagem dos valores simulados superiores à soma da média com o desvio padrão amostrais
count <- sum(sample > sum_mean_std)
# Cálculo da proporção
proportion <- count / n
print(paste("A proporção é:", round(proportion, 4)))
set.seed(1840)
n <- 1192
p <- 0.35
sample <- numeric(n)
# Simulação da distribuição geométrica de parâmetro p
for (i in 1:n) {
u <- runif(1)
x <- floor(log(1 - u) / log(1 - p))
sample[i] <- x
}
# Cálculo da média e do desvio padrão amostrais
mean <- mean(sample)
std <- sd(sample)
# Cálculo da soma da média com o desvio padrão amostrais
sum_mean_std <- mean + std
# Contagem dos valores simulados superiores à soma da média com o desvio padrão amostrais
count <- sum(sample > sum_mean_std)
# Cálculo da proporção
proportion <- count / n
print(paste("A proporção é:", round(proportion, 4)))
set.seed(1840)
n <- 1192
p <- 0.35
sample <- numeric(n)
# Simulação da distribuição geométrica de parâmetro p
for (i in 1:n) {
u <- runif(1)
x <- floor(log(1 - u) / log(1 - p))
sample[i] <- x
}
# Cálculo da média e do desvio padrão amostrais
mean <- mean(sample)
std <- sd(sample)
# Cálculo da soma da média com o desvio padrão amostrais
sum_mean_std <- mean + std
# Contagem dos valores simulados superiores à soma da média com o desvio padrão amostrais
count <- sum(sample > sum_mean_std)
# Cálculo da proporção
proportion <- count / n
print(paste("A proporção é:", round(proportion, 4)))
set.seed(1616)
sample_sizes <- c(30, 50, 100, 200, 300, 500, 1000)
num_samples <- 1000
p <- 0.2
conf_level <- 0.96
z <- qnorm((1 + conf_level)/2)
average_diff <- numeric(length(sample_sizes))
for (i in 1:length(sample_sizes)) {
n <- sample_sizes[i]
diff_lengths <- numeric(num_samples)
for (j in 1:num_samples) {
sample <- rbinom(n, 1, p)
sample_mean <- mean(sample)
# Method 1
grid_search <- function(p, sample_mean, n, z) {
abs(sample_mean^2 - 2*sample_mean*p + p^2 - z^2*p*(1-p)/n)
}
p_vals <- seq(0, 1, 0.001)
diffs <- sapply(p_vals, grid_search, sample_mean=sample_mean, n=n, z=z)
p_lower1 <- p_vals[which.min(diffs[1:floor(length(diffs)/2)])]
p_upper1 <- p_vals[which.min(diffs[(floor(length(diffs)/2)+1):length(diffs)]) + floor(length(diffs)/2)]
# Method 2
se <- sqrt(sample_mean * (1-sample_mean) / n)
p_lower2 <- sample_mean - z*se
p_upper2 <- sample_mean + z*se
# Difference in lengths
diff_lengths[j] <- (p_upper2 - p_lower2) - (p_upper1 - p_lower1)
}
average_diff[i] <- mean(diff_lengths)
}
# Plot the result
plot(sample_sizes, average_diff, type = "b", lwd = 2,
xlab = "Sample size", ylab = "Average difference in lengths",
main = "Difference between the methods")
set.seed(1918)
tamanho_amostra <- c(30, 50, 100, 200, 300, 500, 1000)
k <- 3000
p <- 0.6
nivel_conf <- 0.93
z <- qnorm((1 + nivel_conf)/2)
dif_media <- numeric(length(tamanho_amostra))
for (i in 1:length(tamanho_amostra)) {
n <- tamanho_amostra[i]
dif_comp <- numeric(k)
for (j in 1:k) {
amostra <- rbinom(n, 1, p)
amostra_media <- mean(amostra)
# Method 1
proc <- function(p, amostra_media, n, z) {
abs(amostra_media^2 - 2*amostra_media*p + p^2 - z^2*p*(1-p)/n)
}
p_valores <- seq(0, 1, 0.001)
diferenca <- sapply(p_valores, proc, amostra_media=amostra_media, n=n, z=z)
p_bai1 <- p_valores[which.min(diferenca[1:floor(length(diferenca)/2)])]
p_cim1 <- p_valores[which.min(diferenca[(floor(length(diferenca)/2)+1):length(diferenca)]) + floor(length(diferenca)/2)]
# Method 2
se <- sqrt(amostra_media * (1-amostra_media) / n)
p_bai2 <- amostra_media - z*se
p_cim2 <- amostra_media + z*se
# Difference in lengths
dif_comp[j] <- (p_cim2 - p_bai2) - (p_cim1 - p_bai1)
}
dif_media[i] <- mean(dif_comp)
}
# Plot the result
plot(tamanho_amostra, dif_media, type = "b", lwd = 2,
xlab = "Tamanho da amostra", ylab = "diferença entre a média de comprimentos",
main = "Diferência entre os métodos")
set.seed(1918)
tamanho_amostra <- c(30, 50, 100, 200, 300, 500, 1000)
k <- 3000
p <- 0.6
nivel_conf <- 0.93
z <- qnorm((1 + nivel_conf)/2)
dif_media <- numeric(length(tamanho_amostra))
for (i in 1:length(tamanho_amostra)) {
n <- tamanho_amostra[i]
dif_comp <- numeric(k)
for (j in 1:k) {
amostra <- rbinom(n, 1, p)
amostra_media <- mean(amostra)
# Metodo 1
proc <- function(p, amostra_media, n, z) {
abs(amostra_media^2 - 2*amostra_media*p + p^2 - z^2*p*(1-p)/n)
}
p_valores <- seq(0, 1, 0.001)
diferenca <- sapply(p_valores, proc, amostra_media=amostra_media, n=n, z=z)
p_bai1 <- p_valores[which.min(diferenca[1:floor(length(diferenca)/2)])]
p_cim1 <- p_valores[which.min(diferenca[(floor(length(diferenca)/2)+1):length(diferenca)]) + floor(length(diferenca)/2)]
# Metodo 2
se <- sqrt(amostra_media * (1-amostra_media) / n)
p_bai2 <- amostra_media - z*se
p_cim2 <- amostra_media + z*se
dif_comp[j] <- (p_cim2 - p_bai2) - (p_cim1 - p_bai1)
}
dif_media[i] <- mean(dif_comp)
}
plot(tamanho_amostra, dif_media, type = "b", lwd = 2,
xlab = "Tamanho da amostra", ylab = "Diferenças médias",
main = "Diferência entre os métodos")
set.seed(1918)
tamanho_amostra <- c(30, 50, 100, 200, 300, 500, 1000)
k <- 3000
p <- 0.6
nivel_conf <- 0.93
z <- qnorm((1 + nivel_conf)/2)
dif_media <- numeric(length(tamanho_amostra))
for (i in 1:length(tamanho_amostra)) {
n <- tamanho_amostra[i]
dif_comp <- numeric(k)
for (j in 1:k) {
amostra <- rbinom(n, 1, p)
amostra_media <- mean(amostra)
# Metodo 1
proc <- function(p, amostra_media, n, z) {
abs(amostra_media^2 - 2*amostra_media*p + p^2 - z^2*p*(1-p)/n)
}
p_valores <- seq(0, 1, 0.001)
diferenca <- sapply(p_valores, proc, amostra_media=amostra_media, n=n, z=z)
p_bai1 <- p_valores[which.min(diferenca[1:floor(length(diferenca)/2)])]
p_cim1 <- p_valores[which.min(diferenca[(floor(length(diferenca)/2)+1):length(diferenca)]) + floor(length(diferenca)/2)]
# Metodo 2
se <- sqrt(amostra_media * (1-amostra_media) / n)
p_bai2 <- amostra_media - z*se
p_cim2 <- amostra_media + z*se
dif_comp[j] <- (p_cim2 - p_bai2) - (p_cim1 - p_bai1)
}
dif_media[i] <- mean(dif_comp)
}
plot(tamanho_amostra, dif_media, type = "b", lwd = 2,
xlab = "Tamanho da amostra", ylab = "Diferenças médias",
main = "Diferênça entre os métodos")
set.seed(1918)
tamanho_amostra <- c(30, 50, 100, 200, 300, 500, 1000)
k <- 3000
p <- 0.6
nivel_conf <- 0.93
z <- qnorm((1 + nivel_conf)/2)
dif_media <- numeric(length(tamanho_amostra))
for (i in 1:length(tamanho_amostra)) {
n <- tamanho_amostra[i]
dif_comp <- numeric(k)
for (j in 1:k) {
amostra <- rbinom(n, 1, p)
amostra_media <- mean(amostra)
# Metodo 1
proc <- function(p, amostra_media, n, z) {
abs(amostra_media^2 - 2*amostra_media*p + p^2 - z^2*p*(1-p)/n)
}
p_valores <- seq(0, 1, 0.001)
diferenca <- sapply(p_valores, proc, amostra_media=amostra_media, n=n, z=z)
p_bai1 <- p_valores[which.min(diferenca[1:floor(length(diferenca)/2)])]
p_cim1 <- p_valores[which.min(diferenca[(floor(length(diferenca)/2)+1):length(diferenca)]) + floor(length(diferenca)/2)]
# Metodo 2
se <- sqrt(amostra_media * (1-amostra_media) / n)
p_bai2 <- amostra_media - z*se
p_cim2 <- amostra_media + z*se
dif_comp[j] <- (p_cim2 - p_bai2) - (p_cim1 - p_bai1)
}
dif_media[i] <- mean(dif_comp)
}
plot(tamanho_amostra, dif_media, type = "b", lwd = 2,
xlab = "Tamanho da amostra", ylab = "Diferenças médias",
main = "Diferença entre os métodos")
setwd("~/Desktop/IST/Probabilidades e Estatística/ProjetoPE2023/Ex9")
set.seed(1918)
# Valores de n
n_values <- c(30, 50, 100, 200, 300, 500, 1000)
# Constantes e inicializacao de valores
k <- 3000  # Numero de amostras
p <- 0.6  # Parametro Bernoulli
c <- 0.93 # Nivel de confianca
z <- qnorm(((1+c)/2), mean = 0, sd = 1)
i <- 1
media_diferencas <- numeric(length(n_values))
# Função que gera amostras Bernoulli
gerador_amostras_bernoulli <- function(n) {
matrix(rbinom(n * k, size = 1, prob = p), nrow = k, ncol = n)
}
# Loop sobre os valores de n e geracao de 2500 amostras para cada
for (n in n_values) {
# Geracao das amostras
amostras <- gerador_amostras_bernoulli(n)
diferenca_intervalos <- numeric(k)
# Loop que calcula os IC's pelo metodo 1 e 2 e a diferenca de comprimento
for (j in 1:k)  {
x_media <- mean(amostras[j,])
# Metodo 1, resolvemos a equacao de 2o grau
a <- 1+z^2/n
b <- -2*x_media-z^2/n
c <- x_media^2
eq_matrix <- matrix(c(a, b, c), nrow = 1)
intervalo_confianca_1 <- sort(Re(polyroot(eq_matrix)))
# Metodo 2, abordagem tradicional
desvio_padrao = sqrt(x_media * (1 - x_media) / n)
margem_erro <- qnorm(1 - (1 - c) / 2) * desvio_padrao
intervalo_confianca_2 <- c(x_media - margem_erro, x_media + margem_erro)
# Diferenca entre o comprimento dos intervalos
diferenca_intervalos[j] <- ((intervalo_confianca_2[2] - intervalo_confianca_2[1])
- (intervalo_confianca_1[2] - intervalo_confianca_1[1]))
}
media_diferencas[i] = mean(diferenca_intervalos)
i <- i+1
}
plot(n_values, media_diferencas, type = "b", lwd = 3,
xlab = "Tamanho amostra", ylab = "Diferença médias",
main = "Diferença Método 1 e 2")
set.seed(1918)
tamanho_amostra <- c(30, 50, 100, 200, 300, 500, 1000)
k <- 3000
p <- 0.6
nivel_conf <- 0.93
z <- qnorm((1 + nivel_conf)/2)
dif_media <- numeric(length(tamanho_amostra))
for (i in 1:length(tamanho_amostra)) {
n <- tamanho_amostra[i]
dif_comp <- numeric(k)
for (j in 1:k) {
amostra <- rbinom(n, 1, p)
amostra_media <- mean(amostra)
# Metodo 1
proc <- function(p, amostra_media, n, z) {
abs(amostra_media^2 - 2*amostra_media*p + p^2 - z^2*p*(1-p)/n)
}
p_valores <- seq(0, 1, 0.001)
diferenca <- sapply(p_valores, proc, amostra_media=amostra_media, n=n, z=z)
p_bai1 <- p_valores[which.min(diferenca[1:floor(length(diferenca)/2)])]
p_cim1 <- p_valores[which.min(diferenca[(floor(length(diferenca)/2)+1):length(diferenca)]) + floor(length(diferenca)/2)]
# Metodo 2
se <- sqrt(amostra_media * (1-amostra_media) / n)
p_bai2 <- amostra_media - z*se
p_cim2 <- amostra_media + z*se
dif_comp[j] <- (p_cim2 - p_bai2) - (p_cim1 - p_bai1)
}
dif_media[i] <- mean(dif_comp)
}
plot(tamanho_amostra, dif_media, type = "b", lwd = 2,
xlab = "Tamanho da amostra", ylab = "Diferenças médias",
main = "Diferença entre os métodos")
set.seed(1918)
n_values <- c(30, 50, 100, 200, 300, 500, 1000)
k <- 3000
p <- 0.6
c <- 0.93
z <- qnorm(((1+c)/2), mean = 0, sd = 1)
i <- 1
media_diferencas <- numeric(length(n_values))
gerador_amostras_bernoulli <- function(n) {
matrix(rbinom(n * k, size = 1, prob = p), nrow = k, ncol = n)
}
for (n in n_values) {
amostras <- gerador_amostras_bernoulli(n)
diferenca_intervalos <- numeric(k)
for (j in 1:k)  {
x_media <- mean(amostras[j,])
a <- 1+z^2/n
b <- -2*x_media-z^2/n
c <- x_media^2
eq_matrix <- matrix(c(a, b, c), nrow = 1)
intervalo_confianca_1 <- sort(Re(polyroot(eq_matrix)))
desvio_padrao = sqrt(x_media * (1 - x_media) / n)
margem_erro <- qnorm(1 - (1 - c) / 2) * desvio_padrao
intervalo_confianca_2 <- c(x_media - margem_erro, x_media + margem_erro)
diferenca_intervalos[j] <- ((intervalo_confianca_2[2] - intervalo_confianca_2[1])
- (intervalo_confianca_1[2] - intervalo_confianca_1[1]))
}
media_diferencas[i] = mean(diferenca_intervalos)
i <- i+1
}
plot(n_values, media_diferencas, type = "b", lwd = 3,
xlab = "Tamanho amostra", ylab = "Diferença médias",
main = "Diferença entre Métodos")
